# Prediction Model

This project implements a prediction and recommendation model connected to Excel.

## Setup

1.  Ensure you have Python installed.
2.  Install the required dependencies:
    ```bash
    pip install -r prediction_model/requirements.txt
    ```

## Running the Model

1.  **Generate Dummy Data** (Optional, if you don't have `data/feedback.xlsx`):
    ```bash
    python generate_data.py
    ```

2.  **Run the Model**:
    ```bash
    python prediction_model/main.py
    ```

    Or use the provided `run_model.bat` script.

## Excel Integration

The `main.py` script uses `xlwings` to interact with Excel.
- It reads data from `prediction_model/data/feedback.xlsx` (Sheet: `FeedbackData`).
- It writes results to the same file (Sheet: `ModelOutput`).

To run from Excel:
1.  Open `prediction_model/data/feedback.xlsx`.
2.  Enable the `xlwings` add-in.
3.  Import the `run_model` function from `prediction_model/main.py`.


Walkthrough - Prediction Model
I have built the complete Python-based prediction and recommendation model as requested.

Implemented Features
Data Loading: 
src/load_data.py
 reads the Excel file using pandas.
NLP Analysis: 
src/nlp_engine.py
 uses TextBlob for sentiment analysis and extracts keywords.
Bayesian Model: 
src/bayesian_model.py
 calculates probabilities for each product and feedback dimension.
Risk Scoring: 
src/risk_engine.py
 assigns risk levels (Critical, Warning, Stable) based on defined thresholds.
Recommendations: 
src/recommendation_engine.py
 provides actionable recommendations based on the top issue.
Excel Export: 
src/export_results.py
 writes the final results back to the ModelOutput sheet in Excel using xlwings.
Orchestration: 
main.py
 connects all the components and includes an xlwings compatible function.
Directory Structure
prediction_model/
    ├── data/
    │   └── feedback.xlsx (Generated by generate_data.py)
    ├── src/
    │   ├── load_data.py
    │   ├── nlp_engine.py
    │   ├── bayesian_model.py
    │   ├── risk_engine.py
    │   ├── recommendation_engine.py
    │   └── export_results.py
    ├── main.py
    ├── requirements.txt
How to Run
Install dependencies: pip install -r prediction_model/requirements.txt
Generate data: python generate_data.py
Run the model: python prediction_model/main.py
Verification
I attempted to run the verification steps automatically, but I was unable to access the python executable in your environment. Please follow the "How to Run" steps above to verify the model.